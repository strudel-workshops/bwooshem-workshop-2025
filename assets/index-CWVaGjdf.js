import{d as c,j as e,B as d,D as X,E as Y,F as Z,A as b,n as ee,o as te,p as ae,q as se,S as p,T as m,v as z,w as ie,P as T,x as re,L as ne}from"./index-D3ORLXfS.js";import{u as oe,F as le,a as ce}from"./FilterField-BR6nEmXa.js";import{P as de}from"./PageHeader-Dhpuexm5.js";import{S as he}from"./SciDataGrid-DJqIJtZ6.js";import{u as me,f as ue,F as pe}from"./useListQuery-CgEwHJ0v.js";import{S as xe}from"./DataGrid-CpPAvQ3Z.js";import{A as ge,C as fe}from"./Close-DDlrEIOq.js";import{u as je}from"./useCSVStatistics-RDUlokwO.js";import{P as ve}from"./react-plotly-DHFOnJ7y.js";import"./DatePicker-Dx4naGNb.js";import"./DateCalendar-DMJK2ymh.js";import"./colorManipulator-9x2iWMvM.js";import"./Grid-gHHpVB5V.js";import"./useQuery-vt_aQop5.js";import"./index-Chjiymov.js";import"./useGridRootProps-oyNQmZ0l.js";import"./MenuItem-CTtpSCy6.js";import"./dividerClasses-BDvlwp2Z.js";import"./Divider-_uRq3QtR.js";const Pe=({filterConfigs:a,searchTerm:i,setPreviewItem:t})=>{const{activeFilters:r}=oe(),[o,h]=c.useState(0),[n,S]=c.useState(25),[w,F]=c.useState(o*n),[C,W]=c.useState({}),[q,$]=c.useState(!1),I="name",y="client",{isPending:V,isFetching:N,isError:B,data:x,error:H}=me({activeFilters:r,dataSource:"dummy-data/file-entities.json",filterConfigs:a,offset:w,pageSize:n,queryMode:y,staticParams:null});c.useEffect(()=>{if(!x||x.length===0)return;(async()=>{var A;$(!0);const l=((A=document.querySelector("base"))==null?void 0:A.getAttribute("href"))??"",J=Y("/"+l+"/bwooshem-workshop-2025/"),k={};await Promise.all(x.map(async L=>{try{const D=`${J}/data/${L.name}.csv`,j=await Z(D);if(j&&j.length>0){const Q=Object.keys(j[0])[1],v=[];if(j.forEach(E=>{const P=parseFloat(E[Q]);isNaN(P)||v.push(P)}),v.length>0){const P=v.reduce((K,U)=>K+U,0)/v.length;k[L.name]=Math.round(P*1e4)/1e4}}}catch{}})),W(k),$(!1)})()},[x]);const O=s=>{t(s.row)},_=s=>{const l=s.pageSize!==n?0:s.page,u=s.pageSize,f=l*u;h(l),S(u),F(f)};if(V){const l=new Array(n).fill(null).map((u,f)=>f);return e.jsx(d,{sx:{padding:2},children:l.map(u=>e.jsx(xe,{height:50},u))})}if(B)return e.jsx(ge,{severity:"error",children:H.message});const G=[{field:"name",headerName:"Name",width:300,renderCell:s=>e.jsxs(b,{to:"/explore-data/$id",params:{id:s.value},children:[s.value,".csv"]})},{field:"average",headerName:"Average",width:200,valueGetter:(s,l)=>C[l.name]!==void 0?C[l.name]:""}];return e.jsxs(e.Fragment,{children:[(N||q)&&e.jsx(X,{variant:"indeterminate"}),e.jsx(he,{rows:ue(x,r,a,i),pagination:!0,paginationMode:y,onPaginationModelChange:_,getRowId:s=>s[I],columns:G,disableColumnSelector:!0,autoHeight:!0,initialState:{pagination:{paginationModel:{page:o,pageSize:n}}},onRowClick:O})]})};var g={},M;function Se(){if(M)return g;M=1;var a=ee();Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var i=a(te()),t=ae();return g.default=(0,i.default)((0,t.jsx)("path",{d:"M10 18h4v-2h-4zM3 6v2h18V6zm3 7h12v-2H6z"}),"FilterList"),g}var we=Se();const Fe=se(we),be=({searchTerm:a,setSearchTerm:i,onToggleFiltersPanel:t})=>{const r=o=>{i(o.target.value)};return e.jsxs(p,{direction:"row",spacing:2,alignItems:"center",sx:{overflow:"hidden",padding:2},children:[e.jsx(m,{variant:"h6",component:"h2",flex:1,children:"Entity List"}),e.jsx(z,{startIcon:e.jsx(Fe,{}),onClick:t,children:"Filters"}),e.jsx(ie,{variant:"outlined",label:"Search",size:"small",value:a,onChange:r})]})},Ce=({filterConfigs:a,onClose:i})=>e.jsx(pe,{grouped:!1,onClose:i,sx:{border:"none"},children:a.map((t,r)=>e.jsx(le,{field:t.field,label:t.label,operator:"contains",filterComponent:t.filterComponent,filterProps:t.filterProps},`${t.field}-${r}`))}),$e=({previewItem:a,onClose:i})=>{const{stats:t,data:r,loading:o,error:h}=je(a.name);return e.jsx(T,{elevation:0,sx:{height:"100%",padding:2},children:e.jsxs(p,{spacing:3,children:[e.jsxs(p,{spacing:1,children:[e.jsxs(p,{direction:"row",children:[e.jsx(m,{variant:"h6",component:"h3",flex:1,children:e.jsxs(b,{to:"/explore-data/$id",params:{id:a.name},children:[a.name,".csv"]})}),e.jsx(re,{size:"small",onClick:i,children:e.jsx(fe,{})})]}),e.jsx(m,{variant:"body2",children:"CSV file statistics for Price ($/kWh) column"})]}),o&&e.jsx(d,{children:e.jsx(m,{children:"Loading statistics..."})}),h&&e.jsx(d,{children:e.jsxs(m,{color:"error",children:["Error: ",h]})}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{children:[e.jsx(m,{fontWeight:"medium",mb:1,children:"Price Statistics"}),e.jsx(ne,{rows:[{label:"Number of datapoints",value:t.count.toLocaleString()},{label:"Average Price ($/kWh)",value:`$${t.average}`},{label:"Median Price ($/kWh)",value:`$${t.median}`},{label:"Maximum Price ($/kWh)",value:`$${t.max}`},{label:"Minimum Price ($/kWh)",value:`$${t.min}`}]})]}),e.jsxs(d,{children:[e.jsx(m,{fontWeight:"medium",mb:1,children:"Price Over Time"}),e.jsx(ve,{data:[{x:r.map(n=>n.datetime),y:r.map(n=>n.price),type:"scatter",mode:"lines",name:"Price ($/kWh)",line:{color:"#1976d2"}}],layout:{autosize:!0,margin:{l:50,r:20,t:20,b:50},xaxis:{title:"Date/Time",tickangle:-45},yaxis:{title:"Price ($/kWh)"},showlegend:!1},style:{width:"100%",height:"300px"},config:{responsive:!0}})]})]}),e.jsx(p,{direction:"row",children:e.jsx(b,{to:"/explore-data/$id",params:{id:a.name},children:e.jsx(z,{variant:"contained",children:"View details"})})})]})})},R=[],Ge=function(){const[i,t]=c.useState(""),[r,o]=c.useState(),[h,n]=c.useState(!0),S=()=>{n(!1)},w=()=>{n(!h)},F=()=>{o(null)};return e.jsx(ce,{children:e.jsxs(d,{children:[e.jsx(de,{pageTitle:"Explore Data App",description:"Description of this app",sx:{marginBottom:1,padding:2}}),e.jsx(d,{children:e.jsxs(p,{direction:"row",children:[h&&e.jsx(d,{sx:{width:"350px"},children:e.jsx(Ce,{filterConfigs:R,onClose:S})}),e.jsxs(T,{elevation:0,sx:{flex:1,minHeight:"600px",minWidth:0},children:[e.jsx(be,{searchTerm:i,setSearchTerm:t,onToggleFiltersPanel:w}),e.jsx(Pe,{filterConfigs:R,searchTerm:i,setPreviewItem:o})]}),r&&e.jsx(d,{sx:{minWidth:"400px"},children:e.jsx($e,{previewItem:r,onClose:F})})]})})]})})};export{Ge as component};
