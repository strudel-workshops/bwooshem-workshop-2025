import{aq as E,d as c,j as t,S as n,B as m,bl as L,bm as p,bn as h,A as i,T as e,C as W,P as D,v as C,bs as P,bt as R,bu as $}from"./index-CcL4YOBG.js";import{C as T}from"./CircularProgress-Dp4W1gtx.js";const H=function(){const{state:w,dispatch:S}=E(),[x,o]=c.useState(!0),[l,u]=c.useState(null),[s,y]=c.useState(null);return c.useEffect(()=>{(async()=>{try{o(!0);const{inputParameters:r,selectedDataset:g}=w;if(!r||!g){u("Missing input parameters or dataset selection. Please go back and complete the form."),o(!1);return}const v=`/data/${g}.csv`,a=await fetch(v);if(!a.ok)throw new Error(`Failed to load CSV file: ${a.status} ${a.statusText}`);const j=(await a.text()).split(`
`).slice(1).filter(d=>d.trim()).map(d=>{const b=d.split(",");return{datetime:b[0].trim(),price:parseFloat(b[1].trim())}});if(j.length===0)throw new Error("No data found in CSV file");const f=P(j,r.hourlyLoadProfile),k=R(f);y(k),S($(f)),o(!1)}catch(r){u(r instanceof Error?r.message:"Calculation failed"),o(!1)}})()},[]),t.jsxs(n,{spacing:0,flex:1,children:[t.jsx(m,{sx:{backgroundColor:"white",padding:2,borderBottom:"1px solid",borderColor:"neutral.main"},children:t.jsxs(L,{activeStep:2,sx:{maxWidth:850},children:[t.jsx(p,{children:t.jsx(h,{children:t.jsx(i,{to:"/run-computation/$id/data-inputs",params:{id:"new"},sx:{color:"inherit",textDecoration:"none"},children:"Data Inputs"})})},"Data Inputs"),t.jsx(p,{children:t.jsx(h,{children:t.jsx(i,{to:"/run-computation/$id/settings",params:{id:"new"},sx:{color:"inherit",textDecoration:"none"},children:"Optimization Settings"})})},"Optimization Settings"),t.jsx(p,{children:t.jsx(h,{children:t.jsx(i,{to:"/run-computation/$id/results",params:{id:"new"},sx:{color:"inherit",textDecoration:"none"},children:"Results"})})},"Results")]})}),t.jsxs(n,{direction:"row",spacing:0,flex:1,children:[t.jsxs(n,{component:"ul",direction:"column",spacing:0,sx:{backgroundColor:"white",listStyle:"none",margin:0,padding:4,width:300},children:[t.jsx(e,{component:"li",fontWeight:"bold",sx:{marginBottom:2},children:"Categories"}),t.jsx(e,{component:"li",sx:{backgroundColor:"#D9EEFE",borderRight:"4px solid",borderColor:"primary.main",padding:"1rem 2rem",marginLeft:"-2rem !important",marginRight:"-2rem !important"},children:"Summary"}),t.jsx(e,{component:"li",sx:{padding:"1rem 2rem",marginLeft:"-2rem !important",marginRight:"-2rem !important"},children:"System Costing"}),t.jsx(e,{component:"li",sx:{padding:"1rem 2rem",marginLeft:"-2rem !important",marginRight:"-2rem !important"},children:"System Metrics"})]}),t.jsx(m,{flex:1,children:t.jsx(W,{maxWidth:"md",sx:{mt:4},children:t.jsxs(D,{sx:{padding:4},children:[x&&t.jsxs(n,{alignItems:"center",spacing:2,children:[t.jsx(T,{}),t.jsx(e,{children:"Calculating results..."})]}),l&&t.jsxs(n,{spacing:2,children:[t.jsx(e,{color:"error",variant:"h6",children:"Error"}),t.jsx(e,{color:"error",children:l}),t.jsx(i,{to:"/run-computation/$id/settings",params:{id:"new"},children:t.jsx(C,{variant:"contained",children:"Back to Settings"})})]}),!x&&!l&&s&&t.jsxs(n,{spacing:3,children:[t.jsx(e,{variant:"h5",component:"h2",fontWeight:"bold",children:"Calculation Summary"}),t.jsxs(n,{spacing:2,children:[t.jsxs(n,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsx(e,{variant:"h6",children:"Total Cost:"}),t.jsxs(e,{variant:"h4",color:"primary",fontWeight:"bold",children:["$",s.totalCost]})]}),t.jsxs(n,{direction:"row",justifyContent:"space-between",children:[t.jsx(e,{fontWeight:"bold",children:"Average Cost per Hour:"}),t.jsxs(e,{children:["$",s.averageCost]})]}),t.jsxs(n,{direction:"row",justifyContent:"space-between",children:[t.jsx(e,{fontWeight:"bold",children:"Total Load:"}),t.jsxs(e,{children:[s.totalLoad," kW"]})]}),t.jsxs(n,{direction:"row",justifyContent:"space-between",children:[t.jsx(e,{fontWeight:"bold",children:"Average Load:"}),t.jsxs(e,{children:[s.averageLoad," kW"]})]}),t.jsxs(n,{direction:"row",justifyContent:"space-between",children:[t.jsx(e,{fontWeight:"bold",children:"Data Points:"}),t.jsx(e,{children:s.dataPoints})]})]})]})]})})})]}),t.jsx(m,{sx:{backgroundColor:"white",borderTop:"1px solid",borderColor:"neutral.main",bottom:0,padding:2,position:"fixed",width:"100%"},children:t.jsx(i,{to:"/run-computation/$id/settings",params:{id:"new"},children:t.jsx(C,{variant:"contained",children:"Back to Optimization Settings"})})})]})};export{H as component};
